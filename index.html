<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Livraria Construtiva</title>
<style>
/* ===========================
   Reset e estilo geral
=========================== */
* {margin:0; padding:0; box-sizing:border-box;}
body {font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color:#333; overflow-x:hidden;
      background: linear-gradient(135deg, #fdf6e3, #ffd54f);} 

/* ===========================
   Header fixo
=========================== */
header {
  position:fixed; top:0; left:0; right:0;
  background:#FF5722; color:white; padding:1rem 2rem;
  display:flex; justify-content:space-between; align-items:center; z-index:1000;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
}
header h1 {font-size:1.8rem;}
nav a {color:white; margin:0 1rem; text-decoration:none; font-weight:500;}

/* ===========================
   Footer
=========================== */
footer {text-align:center; padding:2rem; color:#777; font-size:0.9rem; background:#FFCCBC; margin-top:2rem;}

/* ===========================
   Grid de livros
=========================== */
main {padding:1rem 2rem 2rem 2rem;}
#livros-container {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:1rem;
}
.livro-card {
  background:white; border-radius:12px; overflow:hidden;
  box-shadow:0 4px 12px rgba(0,0,0,0.2); transition:transform 0.2s;
  display:flex; flex-direction:column; justify-content:space-between;
}
.livro-card:hover {transform:translateY(-5px);}
.livro-card img {width:100%; height:200px; object-fit:cover;}
.livro-info {padding:0.8rem; flex:1; display:flex; flex-direction:column; justify-content:space-between;}
.livro-info h3 {font-size:1rem; margin-bottom:0.3rem; height:40px; overflow:hidden;}
.livro-info p {font-size:0.85rem; color:#555; margin-bottom:0.5rem; height:18px; overflow:hidden;}
.livro-info button {
  width:100%; padding:0.5rem; border:none; border-radius:6px;
  background:#FF5722; color:white; font-weight:600; cursor:pointer; transition:background 0.2s;
}
.livro-info button:hover {background:#E64A19;}

/* ===========================
   Filtros
=========================== */
#filtros {
  margin-top:120px;
  text-align:center;
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:0.5rem;
}
#filtros input, #filtros select {
  padding:0.6rem 1rem;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:1rem;
  width:250px;
  max-width:90%;
}

/* ===========================
   BotÃ£o elegante na Home
=========================== */
#btnLivros {
  margin-top:20px;
  padding:14px 28px;
  font-size:1.1rem;
  color:white;
  background:linear-gradient(45deg,#FF5722,#FF9800);
  border:none;
  border-radius:50px;
  cursor:pointer;
  box-shadow:0 6px 15px rgba(0,0,0,0.3);
  transition:transform 0.2s, box-shadow 0.2s;
}
#btnLivros:hover {
  transform:translateY(-3px);
  box-shadow:0 8px 20px rgba(0,0,0,0.4);
}

/* ===========================
   Contato
=========================== */
#contato a {
  color:#FF5722;
  text-decoration:none;
  font-weight:600;
  margin:0 5px;
  transition: color 0.3s;
}
#contato a:hover {color:#E64A19;}

/* ===========================
   Barra de progresso e botÃ£o topo
=========================== */
#progress-bar {
  position:fixed; top:0; left:0; height:4px; background:#FFC107; width:0; z-index:1001; transition:width 0.2s;
}
#btnTopo {
  display:none;
  position:fixed;
  bottom:40px;
  right:40px;
  z-index:1002;
  background:#FF5722;
  color:white;
  border:none;
  padding:12px 16px;
  border-radius:50px;
  cursor:pointer;
  font-size:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.3);
  transition:background 0.3s;
}

/* ===========================
   Pop-up e modal
=========================== */
#popup, #modal-download {
  display:none;
  position:fixed; top:50%; left:50%; transform:translate(-50%, -50%);
  background:white; padding:20px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.3);
  z-index:2000; text-align:center;
}
#modal-download button {margin:5px;}

/* ===========================
   BotÃ£o flutuante Livros Especiais
=========================== */
#btnFlutuanteEspecial {
  display:none;
  position:fixed;
  bottom:40px;
  right:40px;
  z-index:1002;
  background:#FF5722;
  color:white;
  border:none;
  padding:12px 16px;
  border-radius:50px;
  cursor:pointer;
  font-size:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.3);
  transition:opacity 0.3s;
}

#btnFlutuanteEspecial {
  display:none;
  position:fixed;
  bottom:100px;  /* afasta do rodapÃ© e dos outros botÃµes */
  right:40px;
  z-index:998;   /* menor que o header (1000) e botÃ£o topo (1002) */
  background:#FF5722;
  color:white;
  border:none;
  padding:12px 16px;
  border-radius:50px;
  cursor:pointer;
  font-size:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.3);
  transition:opacity 0.3s;
}

</style>
</head>
<body>

<!-- Header fixo -->
<header>
  <h1>ðŸ“š Livraria Construtiva</h1>
  <nav>
    <a href="#" onclick="mostrarSecao('home')">Home</a>
    <a href="#" onclick="mostrarSecao('livros')">Livros</a>
    <a href="#" onclick="mostrarSecao('contato')">Contato</a>
  </nav>
</header>

<!-- Barra de progresso -->
<div id="progress-bar"></div>

<!-- BotÃ£o topo -->
<button id="btnTopo" onclick="voltarTopo()">â¬† Topo</button>

<!-- Home -->
<section id="home" style="padding-top:120px; display:block; text-align:center;">
  <h2>ðŸ“š Bem-vindo Ã  Livraria Construtiva</h2>
  <p>Encontre livros gratuitos e comece a explorar!</p>
  <button id="btnLivros" onclick="mostrarSecao('livros')">ðŸ“– Ver Livros</button>
  <br>
  <button id="btnHomeEspecial" 
    style="margin-top:20px;padding:12px 24px;background:#FF5722;color:white;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition: background 0.3s;"
    onclick="abrirWhatsApp('Tens disponÃ­vel o Livro:')"
  >
    Livros Especiais
  </button>
</section>

<!-- BotÃ£o flutuante na pÃ¡gina Livros -->
<button id="btnFlutuanteEspecial" onclick="abrirWhatsApp('Tens disponÃ­vel o Livro:')">
  Livros Especiais
</button>

<!-- Livros -->
<section id="livros" style="padding-top:120px; display:none;">
  <h2>ðŸ“– Livros</h2>
  <div id="filtros">
    <input type="text" id="busca" placeholder="Buscar por tÃ­tulo ou autor...">
    <select id="categoria">
      <option value="">Todas as categorias</option>
      <option value="fiction">FicÃ§Ã£o</option>
      <option value="children">Infantil</option>
      <option value="science">CiÃªncia</option>
      <option value="philosophy">Filosofia</option>
      <option value="history">HistÃ³ria</option>
    </select>
  </div>
  <main>
    <div id="livros-container"></div>
    <div id="loading">Carregando livros...</div>
  </main>
</section>

<!-- Contato -->
<section id="contato" style="padding-top:120px; display:none; text-align:center;">
  <h2>âœ‰ Contato</h2>
  <p>Fale conosco via:</p>
  <p>
    <a href="https://www.facebook.com/profile.php?id=61583174369263" target="_blank">ðŸ“˜ Facebook</a> |
    <a href="https://wa.me/959622160?text=OlÃ¡! Quero saber mais sobre os livros" target="_blank">ðŸ’¬ WhatsApp</a> |
    <a href="mailto:jsacassole@gmail.com?subject=Contato Livraria Construtiva&body=OlÃ¡, gostaria de mais informaÃ§Ãµes.">âœ‰ E-mail</a>
  </p>
</section>

<!-- RodapÃ© -->
<footer>
  <p>Â© 2025 Livraria Construtiva | Todos os livros sÃ£o gratuitos e de domÃ­nio pÃºblico</p>
</footer>

<!-- Pop-up e modal -->
<div id="popup">
  <p>ðŸ“¢ Confira nosso anÃºncio!</p>
  <button onclick="fecharPopup()">Fechar</button>
</div>
<div id="modal-download">
  <p>O download do livro comeÃ§arÃ¡ em breve:</p>
  <button id="btnDownload" onclick="fecharModal()">Fechar</button>
</div>

<script>
/* ===========================
   FunÃ§Ã£o de navegaÃ§Ã£o
=========================== */
function mostrarSecao(secao) {
  const secoes = ['home','livros','contato'];
  secoes.forEach(id => {
    document.getElementById(id).style.display = (id===secao)?'block':'none';
  });
  if(secao==='livros') carregarLivros();
  window.scrollTo({top:0, behavior:'smooth'});
}

/* ===========================
   Scroll suave, botÃ£o topo e barra progresso
=========================== */
const btnTopo = document.getElementById('btnTopo');
const progressBar = document.getElementById('progress-bar');
window.onscroll = function() {
  if(window.scrollY > 300) btnTopo.style.display='block'; else btnTopo.style.display='none';
  const total = document.documentElement.scrollHeight - window.innerHeight;
  progressBar.style.width = `${(window.scrollY/total)*100}%`;
};

function voltarTopo(){
  // subir suavemente atÃ© o topo
  window.scrollTo({top:0, behavior:'smooth'});

  // depois que chegar no topo...
  setTimeout(()=>{
    if(document.getElementById('livros').style.display === 'block'){
      
      // sorteia uma pÃ¡gina aleatÃ³ria entre 1 e 50
      pagina = Math.floor(Math.random() * 50) + 1;

      // limpa os livros atuais
      container.innerHTML = '';

      // carrega livros de uma pÃ¡gina totalmente diferente
      carregarLivros();

    } else if(document.getElementById('home').style.display === 'block'){
      // se estiver no home, recarrega tudo
      location.reload();
    }
  }, 600);
}

/* ===========================
   VariÃ¡veis de controle
=========================== */
let pagina=1, carregando=false, termoBusca='', categoria='', livroAtual=null;
const container = document.getElementById('livros-container');
const loading = document.getElementById('loading');

/* ===========================
   Pop-up e modal
=========================== */
function mostrarPopup(){ document.getElementById('popup').style.display='block'; }
function fecharPopup(){ document.getElementById('popup').style.display='none'; }
function abrirModal(livro){
  livroAtual = livro;
  let link = livro.formats['application/epub+zip'] || livro.formats['text/plain; charset=utf-8'];
  if(!link){
    alert('Formato nÃ£o disponÃ­vel para download.');
    return;
  }
  const a = document.createElement('a');
  a.href = link;
  a.download = livro.title.replace(/[^a-z0-9]/gi,'_') + '.epub';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  document.getElementById('modal-download').style.display='block';
}
function fecharModal(){ document.getElementById('modal-download').style.display='none'; }

/* ===========================
   Carregar livros API Gutendex
=========================== */
async function carregarLivros(){
  if(carregando) return;
  carregando=true; loading.style.display='block'; progressBar.style.width='30%';
  try{
    let url=`https://gutendex.com/books?languages=pt&page=${pagina}`;
    if(categoria) url+=`&topic=${categoria}`;
    if(termoBusca) url+=`&search=${encodeURIComponent(termoBusca)}`;
    const res=await fetch(url); const data=await res.json();
    const livros=data.results;
    if(pagina===1) container.innerHTML='';
    livros.forEach(livro=>{
      const capa = livro.formats['image/jpeg'] || 'https://via.placeholder.com/150x200?text=Sem+Capa';
      const autor = livro.authors.length ? livro.authors[0].name : 'Desconhecido';
      const card = document.createElement('div');
      card.className='livro-card';
      card.innerHTML=`<img src="${capa}" alt="${livro.title}"><div class="livro-info"><h3>${livro.title}</h3><p>${autor}</p><button onclick='abrirModal(${JSON.stringify(livro)})'>ðŸ“¥ Baixar</button></div>`;
      container.appendChild(card);
    });
    pagina++; carregando=false; progressBar.style.width='100%';
    setTimeout(()=>progressBar.style.width='0',300);
    if(!data.next) loading.innerText="Todos os livros carregados.";
  }catch(err){
    console.error(err); loading.innerText="Erro ao carregar livros."; carregando=false; progressBar.style.width='0';
  }
}

/* ===========================
   Scroll infinito
=========================== */
window.addEventListener('scroll', ()=>{
  if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 100){
    carregarLivros();
  }
});

/* ===========================
   Eventos busca e filtro
=========================== */
document.getElementById('busca').addEventListener('input', e=>{
  termoBusca=e.target.value; pagina=1; container.innerHTML=''; carregarLivros();
});
document.getElementById('categoria').addEventListener('change', e=>{
  categoria=e.target.value; pagina=1; container.innerHTML=''; carregarLivros();
});

/* ===========================
   Pop-up em clique
=========================== */
document.addEventListener('click', e=>{
  if(e.target.tagName==='BUTTON' && e.target.innerText.includes('ðŸ“¥')) mostrarPopup();
});

// FunÃ§Ã£o para abrir WhatsApp
function abrirWhatsApp(mensagem){
  const numero = '959622160'; // seu nÃºmero do WhatsApp
  const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;
  window.open(url, '_blank');
}

/* ===========================
   BotÃ£o flutuante Livros Especiais na pÃ¡gina Livros
=========================== */
const btnFlutuante = document.getElementById('btnFlutuanteEspecial');
let timeoutFlutuante;

function mostrarBotaoFlutuante(){
  if(document.getElementById('livros').style.display === 'block'){
    btnFlutuante.style.display = 'block';
    btnFlutuante.style.opacity = '1';
    clearTimeout(timeoutFlutuante);
    timeoutFlutuante = setTimeout(()=>{
      btnFlutuante.style.opacity = '0';
      setTimeout(()=>btnFlutuante.style.display='none',300);
    },5000);
  }
}

// Eventos scroll e toque
window.addEventListener('scroll', mostrarBotaoFlutuante);
window.addEventListener('touchstart', mostrarBotaoFlutuante);

/* ===========================
   Carregar primeira pÃ¡gina
=========================== */
carregarLivros();
</script>
</body>
</html>